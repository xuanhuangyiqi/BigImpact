<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

/**
 * 引用流程接入口 
 */


class Book extends Pixel_Controller
{		
	public function __construct()
	{
		parent::__construct();		
	}
	
	public function index($uid = 0)
	{
		$this->load->helper('url');
		$this->load->helper('date');
		$this->load->database();
		$this->load->model('user_model','',TRUE);
		$this->load->model('work_model','',TRUE);
		$user_result=$this->user_model->get_entry_byuid($uid);
		if (empty($user_result)||$uid==0) 
		{
			show_404();
		}
		else
		{
			$uid=$user_result['uid'];

			$this->curl->create(base_url("/api/book/userinfo/uid/$uid/format/json"));
		        $user_info = json_decode($this->curl->execute(),TRUE);
			$this->template['user_info']=$user_info;

			$this->curl->create(base_url("/api/book/workinfo/uid/$uid/format/json"));
		        $work_info = json_decode($this->curl->execute(),TRUE);
			$this->template['work_info']=$work_info;
			
			$this->template['content'] = $this->load->view('book_views',$this->template,TRUE);
			$this->load->view('template_views',$this->template);
		}
	}
}
/* End of file profile.php */
/* Location: ./application/controllers/profile.php */