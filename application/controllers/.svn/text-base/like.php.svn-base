<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

/**
 * 引用流程接入口 
 */


class Like extends Pixel_Controller
{		
	public function __construct()
	{
		parent::__construct();	
		//$this->load->library('rest', array('server' => 'http://localhost/'));	
	}
	
	public function index()
	{
		$this->load->helper('url');
		$this->load->helper('date');
		$this->load->model('work_model', '', TRUE);
        $this->load->model('user_model','',TRUE);
        $this->load->model('user_like_model','',TRUE);
		$this->load->database();
	
	
		
		$user_info = $this->session->userdata('userdata');

		if (empty($user_info)) 
		{
			show_404();
		}
		else
		{
			$this->template['user_info']=$user_info;
			$uid=$user_info['uid'];

			

			$workids = $this->user_like_model->get_workids_byuid($uid);
            //$work_info = $this->work_model->get_myworklist($uid);
                        $work_info = $this->work_model->get_entryswithlikedate_byworkids($workids,$uid);

			$this->template['work_info']=$work_info;

			//$responce = $this->rest->get('/api/like/workinfos/format/xml', NULL, 'xml');
			//echo "<pre>";
        	//print_r($responce);
        	//echo "</pre>";
        	//echo $this->rest->debug();
			
			$this->template['content'] = $this->load->view('like_views',$this->template,TRUE);
			$this->load->view('template_views',$this->template);
		}
	}
}
/* End of file profile.php */
/* Location: ./application/controllers/profile.php */